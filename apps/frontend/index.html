
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI í‘¸ë“œ ë Œì¦ˆ ë°ëª¨ (ë¶„ë¦¬í˜•)</title>
    <style>
        body { font-family: sans-serif; max-width: 600px; margin: 2em auto; padding: 0 1em; }
        #result { margin-top: 1.5em; padding: 1em; border: 1px solid #ccc; background: #f9f9f9; white-space: pre-wrap; }
        #loading { display: none; color: #888; }
        img { max-width: 100%; height: auto; margin-top: 1em; }
    </style>
</head>
<body>
    <h1>ğŸ“¸ AI í‘¸ë“œ ë Œì¦ˆ ë°ëª¨</h1>
    <p>ë¶„ì„í•˜ê³  ì‹¶ì€ ìŒì‹ ì‚¬ì§„ì„ ì—…ë¡œë“œí•˜ì„¸ìš”.</p>
    
    <form id="upload-form">
        <input type="file" id="file-input" accept="image/*" required>
        <button type="submit">ë¶„ì„í•˜ê¸°</button>
    </form>
    
    <p id="loading">AIê°€ ì—´ì‹¬íˆ ë¶„ì„ ì¤‘ì…ë‹ˆë‹¤... ğŸ§‘â€ğŸ³</p>
    <img id="preview" src="" alt="ì—…ë¡œë“œí•œ ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸°" style="display: none;" />
    <div id="result">
        <p>ì•„ì§ ë¶„ì„ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤. ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•´ ì£¼ì„¸ìš”.</p>
    </div>

    <script>
        const form = document.getElementById('upload-form');
        const fileInput = document.getElementById('file-input');
        const loadingEl = document.getElementById('loading');
        const resultEl = document.getElementById('result');
        const previewEl = document.getElementById('preview');

        // â¬‡ï¸ ì—¬ê¸°ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤ â¬‡ï¸
        const BACKEND_URL = 'http://127.0.0.1:5000/analyze'; 
        // â¬†ï¸ ë°±ì—”ë“œ Flask ì„œë²„ ì£¼ì†Œ â¬†ï¸

        form.addEventListener('submit', async (e) => {
            e.preventDefault(); 

            if (!fileInput.files || fileInput.files.length === 0) {
                alert("íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.");
                return;
            }
            const file = fileInput.files[0];
            
            previewEl.src = URL.createObjectURL(file);
            previewEl.style.display = 'block';
            loadingEl.style.display = 'block';
            resultEl.innerHTML = "<p>ë¶„ì„ ì¤‘...</p>";

            const formData = new FormData();
            formData.append('image_file', file); // 'main.py'ì—ì„œ ë°›ì„ ì´ë¦„

            try {
                // ë°±ì—”ë“œë¡œ íŒŒì¼ ì „ì†¡ (POST)
                const response = await fetch(BACKEND_URL, { // ìˆ˜ì •ëœ URL ì‚¬ìš©
                    method: 'POST',
                    body: formData, 
                });

                if (!response.ok) {
                    const errData = await response.json();
                    throw new Error(errData.error || `HTTP ì—ëŸ¬! ìƒíƒœ: ${response.status}`);
                }

                const data = await response.json();
                
                // ê²°ê³¼ í‘œì‹œ
                resultEl.innerHTML = data.analysis; 

            } catch (error) {
                console.error("ë¶„ì„ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:", error);
                resultEl.innerHTML = `<p style="color: red;">ì˜¤ë¥˜ ë°œìƒ: ${error.message}</p>`;
            } finally {
                loadingEl.style.display = 'none';
            }
        });
    </script>
</body>
</html>